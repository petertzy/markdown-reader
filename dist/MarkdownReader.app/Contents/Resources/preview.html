
            <html>
            <head>
                <meta charset="UTF-8">
                <style>
                    body {
                        background-color: white;
                        color: black;
                        font-family: sans-serif;
                        padding: 20px;
                        font-size: 32px;
                        line-height: 1.6;
                    }
                    pre, code {
                        font-size: 28px;
                        white-space: pre-wrap;
                    }
                    table {
                        border-collapse: collapse;
                        width: 100%;
                        margin-top: 20px;
                    }
                    th, td {
                        text-align: left;
                        border: 1px solid #ccc;
                        padding: 12px 16px;
                        vertical-align: top;
                    }
                    th {
                        background-color: #f3f3f3;
                        color: #333;
                    }
                    tr:nth-child(even) {
                        background-color: #fafafa;
                    }
                </style>
            </head>
            <body>
                <p>å½“ç„¶å¯ä»¥ï¼æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥ã€<strong>è¯¦ç»†è§£é‡Š</strong>ä½ æä¾›çš„è¿™æ®µ Laravel ä¸­é—´ä»¶ä»£ç ã€‚è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªä¸­é—´ä»¶ <code>PreventRequestsDuringMaintenance</code>ï¼Œç”¨äºå¤„ç† Laravel çš„<strong>ç»´æŠ¤æ¨¡å¼ï¼ˆMaintenance Modeï¼‰</strong>ï¼Œæ˜¯ Laravel æ¡†æ¶ä¸­éå¸¸æ ¸å¿ƒçš„ä¸€éƒ¨åˆ†ã€‚</p>

<hr />

<h2>ğŸ§© æ•´ä½“ä½œç”¨ç®€ä»‹</h2>

<p>Laravel æä¾›ä¸€ä¸ªç»´æŠ¤æ¨¡å¼ï¼šå½“ä½ è¿è¡Œ <code>php artisan down</code> å‘½ä»¤æ—¶ï¼Œæ•´ä¸ªç½‘ç«™ä¼šå˜æˆâ€œç»´æŠ¤ä¸­â€ï¼Œé™¤äº†æ˜ç¡®ä¾‹å¤–çš„è¯·æ±‚ï¼Œå…¶ä»–è¯·æ±‚éƒ½ä¼šæ˜¾ç¤ºç»´æŠ¤æç¤ºé¡µé¢ã€‚
è¿™ä¸ªä¸­é—´ä»¶å°±æ˜¯å®ç°è¿™ä¸ªåŠŸèƒ½çš„æ ¸å¿ƒâ€”â€”å®ƒä¼š<strong>æ‹¦æˆªæ‰€æœ‰ HTTP è¯·æ±‚</strong>ï¼Œåœ¨ç»´æŠ¤çŠ¶æ€ä¸‹é˜»æ­¢è®¿é—®ï¼Œé™¤é URL è¢«è®¾ç½®ä¸ºä¾‹å¤–ã€‚</p>

<hr />

<h2>ğŸ“„ é€è¡Œè§£é‡Š</h2>

<hr />

<div class="codehilite">
<pre><span></span><code><span class="cp">&lt;?php</span>
</code></pre>
</div>

<p>PHP è„šæœ¬çš„èµ·å§‹æ ‡è®°ã€‚</p>

<hr />

<div class="codehilite">
<pre><span></span><code><span class="x">namespace App\Http\Middleware;</span>
</code></pre>
</div>

<p>å®šä¹‰è¯¥ç±»æ‰€åœ¨çš„<strong>å‘½åç©ºé—´</strong>ã€‚
è¿™è¯´æ˜è¿™ä¸ªç±»ä½äºé¡¹ç›®è·¯å¾„ <code>app/Http/Middleware/</code> ä¸‹ã€‚</p>

<hr />

<div class="codehilite">
<pre><span></span><code><span class="x">use Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance as Middleware;</span>
</code></pre>
</div>

<p>ä» Laravel æ¡†æ¶ä¸­å¼•å…¥ <code>PreventRequestsDuringMaintenance</code> ä¸­é—´ä»¶ï¼Œå¹¶å°†å®ƒé‡å‘½åä¸º <code>Middleware</code>ã€‚
è¿™æ˜¯ Laravel æ¡†æ¶è‡ªå¸¦çš„ä¸­é—´ä»¶ç±»ï¼Œç”¨æ¥åœ¨ç»´æŠ¤æ¨¡å¼æ—¶é˜»æ­¢éä¾‹å¤–è¯·æ±‚ã€‚</p>

<hr />

<div class="codehilite">
<pre><span></span><code><span class="x">class PreventRequestsDuringMaintenance extends Middleware</span>
</code></pre>
</div>

<p>å®šä¹‰ä¸€ä¸ªç±» <code>PreventRequestsDuringMaintenance</code>ï¼Œå®ƒç»§æ‰¿äº† Laravel è‡ªå¸¦çš„ç»´æŠ¤æ¨¡å¼ä¸­é—´ä»¶ã€‚
é€šè¿‡ç»§æ‰¿ï¼Œæˆ‘ä»¬å¯ä»¥æ‰©å±•æˆ–è€…è‡ªå®šä¹‰å“ªäº›è¯·æ±‚åœ¨ç»´æŠ¤æ¨¡å¼ä¸‹ä»ç„¶å¯ä»¥è®¿é—®ã€‚</p>

<hr />

<div class="codehilite">
<pre><span></span><code><span class="x">    /**</span>
<span class="x">     * The URIs that should be reachable while maintenance mode is enabled.</span>
<span class="x">     *</span>
<span class="x">     * @var array</span>
<span class="x">     */</span>
</code></pre>
</div>

<p>è¿™æ˜¯ä¸€ä¸ªæ³¨é‡Šï¼Œè¯´æ˜æ¥ä¸‹æ¥å®šä¹‰çš„å±æ€§ <code>$except</code> æ˜¯ç”¨æ¥æŒ‡å®šâ€œåœ¨ç»´æŠ¤æ¨¡å¼ä¸‹**å…è®¸è®¿é—®çš„ URIï¼ˆè¯·æ±‚è·¯å¾„ï¼‰â€â€ã€‚</p>

<ul>
<li>æ¯”å¦‚ä½ å¯ä»¥è®¾ç½®æŸäº› API æˆ–åå°æ¥å£åœ¨ç»´æŠ¤æ¨¡å¼æ—¶ä»ç„¶å¯ç”¨ã€‚</li>
</ul>

<hr />

<div class="codehilite">
<pre><span></span><code><span class="x">    protected $except = [</span>
<span class="x">        //</span>
<span class="x">    ];</span>
</code></pre>
</div>

<p>è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåä¸º <code>$except</code>ï¼Œè¡¨ç¤ºç»´æŠ¤æ¨¡å¼ä¸‹çš„<strong>ä¾‹å¤–è·¯å¾„</strong>ã€‚
å½“å‰æ˜¯ç©ºçš„ï¼Œè¡¨ç¤ºâ€œ<strong>æ²¡æœ‰ä»»ä½•è·¯å¾„ä¾‹å¤–ï¼Œç½‘ç«™å®Œå…¨å°é—­</strong>â€ã€‚</p>

<hr />

<h2>ğŸ”§ å®é™…ä½¿ç”¨ç¤ºä¾‹</h2>

<p>å‡è®¾ä½ åœ¨è¿™ä¸ª <code>$except</code> æ•°ç»„ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>

<div class="codehilite">
<pre><span></span><code><span class="x">protected $except = [</span>
<span class="x">    &#39;status&#39;,           // å…è®¸è®¿é—® http://yourdomain.com/status</span>
<span class="x">    &#39;api/health-check&#39;, // å…è®¸è®¿é—® http://yourdomain.com/api/health-check</span>
<span class="x">];</span>
</code></pre>
</div>

<p>é‚£ä¹ˆå½“ç½‘ç«™è¿è¡Œï¼š</p>

<div class="codehilite">
<pre><span></span><code>php<span class="w"> </span>artisan<span class="w"> </span>down
</code></pre>
</div>

<p>è¿›å…¥ç»´æŠ¤æ¨¡å¼åï¼š</p>

<table>
<thead>
<tr>
  <th>URL</th>
  <th>ç»“æœ</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>/</code></td>
  <td>âŒ æ‹’ç»è®¿é—®ï¼Œè¿”å›ç»´æŠ¤é¡µé¢</td>
</tr>
<tr>
  <td><code>/login</code></td>
  <td>âŒ æ‹’ç»è®¿é—®</td>
</tr>
<tr>
  <td><code>/status</code></td>
  <td>âœ… å¯ä»¥æ­£å¸¸è®¿é—®</td>
</tr>
<tr>
  <td><code>/api/health-check</code></td>
  <td>âœ… å¯ä»¥æ­£å¸¸è®¿é—®</td>
</tr>
</tbody>
</table>

<hr />

<h2>ğŸ§  å°çŸ¥è¯†ï¼šç»´æŠ¤æ¨¡å¼åŸç†</h2>

<p>å½“ä½ è¿è¡Œï¼š</p>

<div class="codehilite">
<pre><span></span><code>php<span class="w"> </span>artisan<span class="w"> </span>down
</code></pre>
</div>

<p>Laravel ä¼šåœ¨ <code>storage/framework/</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>down</code> æ–‡ä»¶ï¼Œè¡¨ç¤ºç»´æŠ¤çŠ¶æ€ã€‚
<code>PreventRequestsDuringMaintenance</code> ä¸­é—´ä»¶ä¼šæ£€æŸ¥è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç„¶åé˜»æ­¢è¯·æ±‚ã€‚</p>

<p>ä½ ä¹Ÿå¯ä»¥ä¼ å‚æŒ‡å®šç»´æŠ¤é¡µé¢çš„å†…å®¹ï¼š</p>

<div class="codehilite">
<pre><span></span><code>php<span class="w"> </span>artisan<span class="w"> </span>down<span class="w"> </span>--redirect<span class="o">=</span>/maintenance
</code></pre>
</div>

<hr />

<h2>âœ… æ€»ç»“åŠŸèƒ½ç‚¹</h2>

<table>
<thead>
<tr>
  <th>éƒ¨åˆ†</th>
  <th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
  <td>ç±»å</td>
  <td><code>PreventRequestsDuringMaintenance</code>ï¼Œå¤„ç†ç»´æŠ¤æ¨¡å¼è¯·æ±‚æ‹¦æˆª</td>
</tr>
<tr>
  <td>ç»§æ‰¿</td>
  <td>è‡ª Laravel å®˜æ–¹çš„ç»´æŠ¤æ¨¡å¼ä¸­é—´ä»¶</td>
</tr>
<tr>
  <td><code>$except</code></td>
  <td>åˆ—å‡ºåœ¨ç»´æŠ¤æ¨¡å¼ä¸‹ä»ç„¶å…è®¸è®¿é—®çš„è·¯å¾„ URI</td>
</tr>
<tr>
  <td>é»˜è®¤å€¼</td>
  <td>ç©ºæ•°ç»„ï¼Œè¡¨ç¤ºæ‰€æœ‰è·¯å¾„éƒ½ä¼šè¢«æ‹¦æˆª</td>
</tr>
<tr>
  <td>ä¿®æ”¹æ–¹å¼</td>
  <td>å¯ä»¥æ·»åŠ  URI è·¯å¾„æ¥å®ç°ç™½åå•è®¿é—®</td>
</tr>
</tbody>
</table>

<hr />

<h2>ğŸ§© å¯èƒ½çš„åº”ç”¨åœºæ™¯</h2>

<ol>
<li>ä¿æŒ <code>/status</code> è·¯å¾„å¯¹å¤–ç›‘æ§ç³»ç»Ÿå¯è®¿é—®ï¼ˆå¦‚ UptimeRobotã€Pingdomï¼‰ã€‚</li>
<li>å…è®¸ç®¡ç†å‘˜åå°ä»ç„¶å¯ä»¥è®¿é—®ç»´æŠ¤ç•Œé¢è¿›è¡Œæ“ä½œã€‚</li>
<li>æä¾› API çš„éƒ¨åˆ†æ¥å£åœ¨ç»´æŠ¤æœŸä»å¯æœåŠ¡äºå®¢æˆ·ç«¯ã€‚</li>
</ol>

<hr />

<p>å¦‚éœ€æˆ‘è¿›ä¸€æ­¥æ¼”ç¤ºå¦‚ä½•è¿›å…¥/é€€å‡ºç»´æŠ¤æ¨¡å¼ï¼Œæˆ–è€…å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰çš„ç»´æŠ¤é¡µé¢ï¼Œä¹Ÿæ¬¢è¿ç»§ç»­é—®æˆ‘ï¼</p>

            </body>
            </html>
            